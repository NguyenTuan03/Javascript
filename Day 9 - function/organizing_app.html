<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../bootstrap-5.0.2-dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>
    <div class="container">
        <h3 class="products mb-3">Add New Product</h3>
        <div class="p-4" style="background: #f2f2f2;">
            <input class="border-0 p-2 rounded" id="addInput" type="text" placeholder="New product">
            <button onclick="add()" class="border-0 rounded text-white py-2 px-3 ms-2" id="add" style="background: #50af50;">Add</button>
        </div>
        <h3 class="mt-5">Display All Product</h3>
        <div class="d-flex justify-content-between my-4">
            <h5>Product Name</h5>
            <div class="text-danger" id="count">9 products</div>
        </div>
        <div id="list-product">
            <div class="row mb-3 goods">
                <div class="col-6 list-name--title d-flex justify-content-between">
                    <div class="list-name">Sony Xperia</div>
                </div>
                <div class="col-6">
                    <button class="list-edit rounded text-white bg-green border-0 py-1 px-3 me-5 edit">Edit</button>
                    <button class="list-delete bg-green text-white rounded border-0 py-1 px-3 delete">Delete</button>
                </div>
            </div>
            <div class="row mb-3 goods">
                <div class="col-6 list-name--title d-flex justify-content-between">
                    <div class="list-name">Sony Xperia</div>
                </div>
                <div class="col-6">
                    <button class="list-edit rounded text-white bg-green border-0 py-1 px-3 me-5 edit">Edit</button>
                    <button class="list-delete bg-green text-white rounded border-0 py-1 px-3 delete">Delete</button>
                </div>
            </div>
            <div class="row mb-3 goods">
                <div class="col-6 list-name--title d-flex justify-content-between">
                    <div class="list-name">Sony Xperia</div>
                </div>
                <div class="col-6">
                    <button class="list-edit rounded text-white bg-green border-0 py-1 px-3 me-5 edit">Edit</button>
                    <button class="list-delete bg-green text-white rounded border-0 py-1 px-3 delete">Delete</button>
                </div>
            </div>
            <div class="row mb-3 goods">
                <div class="col-6 list-name--title d-flex justify-content-between">
                    <div class="list-name">Sony Xperia</div>
                </div>
                <div class="col-6">
                    <button class="list-edit rounded text-white bg-green border-0 py-1 px-3 me-5 edit">Edit</button>
                    <button class="list-delete bg-green text-white rounded border-0 py-1 px-3 delete">Delete</button>
                </div>
            </div>
            <div class="row mb-3 goods">
                <div class="col-6 list-name--title d-flex justify-content-between">
                    <div class="list-name">Sony Xperia</div>
                </div>
                <div class="col-6">
                    <button class="list-edit rounded text-white bg-green border-0 py-1 px-3 me-5 edit">Edit</button>
                    <button class="list-delete bg-green text-white rounded border-0 py-1 px-3 delete">Delete</button>
                </div>
            </div>
            <div class="row mb-3 goods">
                <div class="col-6 list-name--title d-flex justify-content-between">
                    <div class="list-name">Sony Xperia</div>
                </div>
                <div class="col-6">
                    <button class="list-edit rounded text-white bg-green border-0 py-1 px-3 me-5 edit">Edit</button>
                    <button class="list-delete bg-green text-white rounded border-0 py-1 px-3 delete">Delete</button>
                </div>
            </div>
            <div class="row mb-3 goods">
                <div class="col-6 list-name--title d-flex justify-content-between">
                    <div class="list-name">Sony Xperia</div>
                </div>
                <div class="col-6">
                    <button class="list-edit rounded text-white bg-green border-0 py-1 px-3 me-5 edit">Edit</button>
                    <button class="list-delete bg-green text-white rounded border-0 py-1 px-3 delete">Delete</button>
                </div>
            </div>
        </div>
    </div>
    <style>
        .bg-green {
            background: #50af50 !important;
        }
    </style>
</body>
<script>
    let addBtn = document.getElementById("add");
    let parentsEle = document.querySelectorAll(".goods");
    let count = document.getElementById("count");
    addToArr()
    function addToArr() {
        let a = [];
        let parentsEle = document.querySelectorAll(".goods");
        parentsEle.forEach((e) => {
            let value = e.querySelector(".list-name").textContent;
            let myObj = {
                name: value 
            }
            a.push(myObj)
        })
        console.log(a); 
        count.innerText = `${a.length} products`
    }
    function add() {
        let name = document.getElementById("addInput").value;
        let list = document.getElementById("list-product");
        let newProduct = document.createElement("div");
        newProduct.innerHTML = `
            <div class="row mb-3 goods">
                <div class="col-6 list-name--title d-flex justify-content-between">
                    <div class="list-name">${name}</div>
                </div>
                <div class="col-6">
                    <button class="list-edit rounded text-white bg-green border-0 py-1 px-3 me-5 edit">Edit</button>
                    <button class="list-delete bg-green text-white rounded border-0 py-1 px-3 delete">Delete</button>
                </div>
            </div>`
        list.appendChild(newProduct)
        document.getElementById("addInput").value = "";
        let a = [];
        let parentsEle = document.querySelectorAll(".goods");
        parentsEle.forEach((e) => {
            let value = e.querySelector(".list-name").textContent;
            let myObj = {
                name: value 
            }
            a.push(myObj)
        })
        document.querySelectorAll(".delete").forEach((e) => {
        e.addEventListener("click",(ele) =>{
                let parentsproduct = ele.target.closest(".goods");
                removeProduct(parentsproduct);
            })
        })
        document.querySelectorAll(".goods").forEach((goodsItem,index) => {
        const editButton = goodsItem.querySelector(".edit");
        editButton.addEventListener("click", (ele) => {
            const existingEditForm = goodsItem.querySelector(".edit_form");
            if (!existingEditForm) {
                const newEdit = document.createElement("div");
                newEdit.classList.add("edit_form");
                newEdit.innerHTML = `
                    <input type="text" class="w-50 goods_edit-value">
                    <button type="button" class="rounded border-0 bg-green text-white save-value">Save</button>
                `;

                const listNameTitle = goodsItem.querySelector(".list-name--title");
                listNameTitle.appendChild(newEdit);
            }
            document.querySelectorAll(".save-value").forEach(item => {
                item.addEventListener("click", (itemChild) => {
                        a[index].name = document.querySelector(".goods_edit-value").value;
                        goodsItem.querySelector(".list-name").innerText = a[index].name
                        goodsItem.querySelector(".edit_form").remove();
                    })
                })
            });
        });
        count.innerText = `${a.length} products`
    }
    function removeProduct(product) {
        product.remove();
        addToArr();
    }
    document.querySelectorAll(".delete").forEach((e) => {
        e.addEventListener("click",(ele) =>{
            let parentsproduct = ele.target.closest(".goods");
            removeProduct(parentsproduct);
        })
    })
    function editproduct() {
        document.querySelectorAll(".edit").forEach((eParents,index) =>{
            eParents.addEventListener("click",(eleParents) =>{
                let openvalue = document.createElement("div");
                openvalue.innerHTML = `<div class="edit_form">
                <input type="text" class="w-50 goods_edit-value">
                <button type="button" class="rounded border-0 bg-green text-white save-value">Save</button>
                </div>
                `
                eleParents.target.closest(".goods").querySelector(".list-name--title").appendChild(openvalue);
                document.querySelectorAll(".save-value").forEach((eChild) =>{
                    eChild.addEventListener("click", (eleChild) =>{
                        a[index].name = document.querySelector(".goods_edit-value").value;
                        eleParents.target.closest(".goods").querySelector(".list-name").innerHTML = a[index].name;
                        eleParents.target.closest(".goods").querySelector(".edit_form").remove();
                    });
                })
            })
        })
    }
    editproduct();
</script>
</html>